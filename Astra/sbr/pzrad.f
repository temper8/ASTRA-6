      subroutine pzrad(iz_imp,ni_imp,coolr)
! written by  A.N.Saveliev, 04.04.2002.
! iz_imp    = impurity Z
! ni_imp(j) = impurity density (10^19/m^3)
! coolr(j)  = cooling rate (MW/m^3)
!
! tables of data are taken from:
! PPPL-1352 July 1977 D.E.Post,R.V.Jensen,C.B.Tarter
!                     W.H.Grasberger and W.A.Lokke
! and
! Atomic Data and Nuclear Data Tables, V.20, 397-439 (1977)
!        D.E.Post, R.V.Jensen, C.B.Tarter, W.H.Grasberger and W.A.Lokke
!
! 19.12.2002 Beryllium added (G.V.Pereverzev)
!
      implicit none
      integer iz_imp,iz,n_tabl
      integer i,j,k,i_read,i_slag,k_beg,kfound
      double precision ni_imp,coolr
      double precision spisok(1739)	!(47 ion species)*(37 data values)
      double precision zero,x_x,pw_out,p_curr
      double precision t_e,work_a,a_coef
      include 'for/parameter.inc'
      include 'for/const.inc'
      include 'for/status.inc'
      dimension n_tabl(92) ! dimension = maximal tabulated Z
      dimension ni_imp(NRD),coolr(NRD)
      dimension a_coef(5,6),t_e(6),work_a(30)
      parameter(zero=0.)
      data n_tabl
! for a given 'iz_imp', data 'n_tabl//' gives first position to read
! from data 'spisok//',   i_read=1+37*[n_tabl(iz_imp)-1]
! if n_tabl(iz_imp)=0, then this ion is not available, cooling rate=0.
! Only 11 ions are now available. It is possible to add all the other.
! To include next, 12th ion from PPPL-1352 July 1977 D.E.Post, .....,
! for instance, Zinc (Z=30), one must add correspondig data
! after last line of 'spisok//' and then put into 'n_tabl(30)=12'
! istead of now written 'n_tabl(30)=0'.
! All the other ions (up to Z=92) can be included using same procedure.
!
     &/0,0,0,12,1,2,0,3,0,4
     &,0,0,0,5,0,0,0,6,0,0
     &,0,7,0,0,0,8,0,9,0,0
     &,0,0,0,0,0,0,0,0,0,0
     &,0,10,0,0,0,0,0,0,0,0
     &,0,0,0,0,0,0,0,0,0,0
     &,0,0,0,0,0,0,0,0,0,0
     &,0,0,0,11,0,0,0,0,0,0
     &,0,0,0,0,0,0,0,0,0,0
     &,0,0/ !92 possible elements = maximal ion charge Z=iz_imp
!
!!!!!!!!!!!!!!!!!!!!!!!!
! BORON
       data (spisok(j),j=1,37)
     &/ 6., 0.002, 0.02, 0.2, 2.0, 20.0, 100.0
     &,-1.508695E+03,-3.512267E+03,-3.286123E+03
     &,-1.520070E+03,-3.470698E+02,-3.127689E+01
     &,-6.370160E+01,-2.156758E+02,-4.308101E+02
     &,-4.222842E+02,-2.008412E+02,-3.687482E+01
     &,-2.147874E+01,-1.565300E-01, 6.181287E-01
     &,-2.477378E-01,-1.060488E-01,-4.537644E-02
     &,-2.147337E+01,-1.829426E-01, 6.678447E-01
     &,-3.864809E-01, 1.165920E-01,-1.400226E-02
     &,-2.446008E+01, 9.264960E+00,-1.110684E+01
     &, 6.837004E+00,-2.065106E+00, 2.458526E-01/
! CARBON
       data (spisok(j),j=38,74)
     &/ 6., 0.003, 0.02, 0.2, 2.0, 20.0, 100.0
     &, 1.965300E+03, 4.572039E+03, 4.159590E+03
     &, 1.871560E+03, 4.173889E+02, 3.699382E+01
     &, 7.467599E+01, 4.549038E+02, 8.372937E+02
     &, 7.402515E+02, 3.147607E+02, 5.164578E+01
     &,-2.120151E+01,-3.668933E-01, 7.295099E-01
     &,-1.944827E-01,-1.263576E-01,-1.491027E-01
     &,-2.121979E+01,-2.346986E-01, 4.093794E-01
     &, 7.874548E-02,-1.841379E-01, 5.590744E-02
     &,-2.476796E+01, 9.408181E+00,-9.657446E+00
     &, 4.999161E+00,-1.237382E+00, 1.160610E-01/
! OXIGEN
       data (spisok(j),j=75,111)
     &/ 6., 0.005, 0.02, 0.2, 2.0, 20.0, 100.0
     &, 6.523740E+02, 1.835499E+03, 1.984266E+03
     &, 1.059846E+03, 2.800476E+02, 2.933792E+01
     &,-5.515118E+01,-1.543956E+02,-2.489920E+02
     &,-1.808154E+02,-5.764174E+01,-6.149181E+00
     &,-2.068816E+01,-7.482238E-01, 7.390959E-01
     &,-6.721590E-01, 1.338345E+00, 3.734628E+00
     &,-2.066766E+01,-9.555590E-01, 1.467982E+00
     &,-9.822488E-01, 4.171964E-01,-8.244216E-02
     &,-2.780602E+01, 2.146056E+01,-2.665906E+01
     &, 1.670831E+01,-5.191943E+00, 6.410295E-01/
! NEON
       data (spisok(j),j=112,148)
     &/ 6., 0.008, 0.02, 0.2, 2.0, 20.0, 100.0
     &, 6.767667E+01, 1.613787E+02, 1.104767E+02
     &, 3.198749E+01, 3.143149E+00, 0.000000E+00
     &,-6.805016E+01,-2.580876E+02,-5.346855E+02
     &,-5.284263E+02,-2.476333E+02,-4.425504E+01
     &,-2.022685E+01,-1.141439E+00, 1.428329E+00
     &, 1.089571E+00,-6.969904E+00,-3.701472E+00
     &,-2.021988E+01,-1.100588E+00, 8.377123E-01
     &, 1.707851E-01,-3.522400E-01, 1.041226E-01
     &,-2.064906E+01, 8.835572E-02,-2.864026E-01
     &, 4.440014E-01,-1.881675E-01, 2.719145E-02/
! SILICON
       data (spisok(j),j=149,185)
     &/ 5., 0.02, 0.2, 2.0, 20.0, 100.0, 0.0
     &,-5.250519E+01,-1.346130E+02,-2.082753E+02
     &,-1.591874E+02,-5.989162E+01,-8.684849E+00
     &,-1.954323E+01, 4.990849E-02,-5.726766E+00
     &,-2.710884E+00, 3.050145E+01, 2.689966E+01
     &,-1.948920E+01,-1.136748E+00,-1.380692E-01
     &, 1.188993E+00,-7.120737E-01, 1.348753E-01
     &,-1.911072E+01,-2.668604E+00, 2.438409E+00
     &,-1.009559E+00, 2.216468E-01,-2.078048E-02
     &, 0.0, 0.0, 0.0
     &, 0.0, 0.0, 0.0/
! ARGON
       data (spisok(j),j=186,222)
     &/ 5., 0.03, 0.2, 2.0, 20.0, 100.0, 0.0
     &,-2.053043E+01,-2.834287E+00, 1.506902E+01
     &, 3.517177E+01, 2.400122E+01, 5.072723E+00
     &,-1.965204E+01,-1.172763E-01, 7.833220E+00
     &,-6.351577E+00,-3.058849E+01,-1.528534E+01
     &,-1.974883E+01, 2.964839E+00,-8.829391E+00
     &, 9.791004E+00,-4.960018E+00, 9.820032E-01
     &,-2.117935E+01, 5.191481E+00,-7.439717E+00
     &, 4.969023E+00,-1.553180E+00, 1.877047E-01
     &, 0.0, 0.0, 0.0
     &, 0.0, 0.0, 0.0/
! TITANIUM
       data (spisok(j),j=223,259)
     &/ 5., 0.02, 0.2, 2.0, 20.0, 100.0, 0.0
     &, 2.391331E+01, 1.833595E+02, 3.019617E+02
     &, 2.376019E+02, 9.049792E+01, 1.345090E+01
     &,-1.899097E+01,-3.403261E+00, 1.439830E+00
     &, 1.735576E+01, 2.804832E-01,-1.943971E+01
     &,-1.929037E+01,-3.260377E+00, 1.454427E+01
     &,-2.383997E+01, 1.642804E+01,-4.084697E+00
     &,-1.341780E+01,-1.675967E+01, 1.843320E+01
     &,-1.033234E+01, 2.960530E+00,-3.423194E-01
     &, 0.0, 0.0, 0.0
     &, 0.0, 0.0, 0.0/
! IRON
       data (spisok(j),j=260,296)
     &/ 5., 0.02, 0.2, 2.0, 20.0, 100.0, 0.0
     &,-2.752599E+01,-3.908228E+01,-6.469423E+01
     &,-5.555048E+01,-2.405568E+01,-4.093160E+00
     &,-1.834973E+01,-1.252028E+00,-7.533115E+00
     &,-3.289693E+00, 2.866739E+01, 2.830249E+01
     &,-1.671042E+01,-1.646143E+01, 3.766238E+01
     &,-3.944080E+01, 1.918529E+01,-3.509238E+00
     &,-2.453957E+01, 1.795222E+01,-2.356360E+01
     &, 1.484503E+01,-4.542323E+00, 5.477462E-01
     &, 0.0, 0.0, 0.0
     &, 0.0, 0.0, 0.0/
! NICKEL
       data (spisok(j),j=297,333)
     &/ 5., 0.03, 0.2, 2.0, 20.0, 100.0, 0.0
     &,-1.203248E+01, 3.253908E+01, 6.790773E+01
     &, 6.529924E+01, 2.973465E+01, 5.271279E+00
     &,-1.830482E+01,-3.319243E-03,-3.332313E+00
     &,-1.112798E+01, 1.053073E-01, 9.448907E+00
     &,-1.697678E+01,-9.495470E+00, 1.109362E+01
     &, 4.045904E-02,-6.521934E+00, 2.654915E+00
     &,-2.864081E+01, 2.999289E+01,-3.726082E+01
     &, 2.258060E+01,-6.716598E+00, 7.911687E-01
     &, 0.0, 0.0, 0.0
     &, 0.0, 0.0, 0.0/
! MOLYBDENUM
       data (spisok(j),j=334,370)
     &/ 5., 0.06, 0.2, 2.0, 20.0, 100.0, 0.0
     &,-1.391054E+02,-6.493335E+02,-1.365838E+03
     &,-1.406464E+03,-7.086213E+02,-1.400571E+02
     &,-1.772591E+01,-1.058217E+00,-3.583172E+00
     &, 1.660089E+00, 8.565372E+00, 4.532909E+00
     &,-1.385096E+01,-3.678452E+01, 1.140587E+02
     &,-1.635634E+02, 1.076260E+02,-2.642488E+01
     &, 3.992683E+01,-1.757093E+02, 2.074927E+02
     &,-1.214589E+02, 3.531804E+01,-4.083832E+00
     &, 0.0, 0.0, 0.0
     &, 0.0, 0.0, 0.0/
! TUNGSTEN
       data (spisok(j),j=371,407)
     &/ 5., 0.1, 0.2, 2.0, 20.0, 100.0, 0.0
     &, 5.340828E+00, 1.560876E+02, 4.171704E+02
     &, 5.502576E+02, 3.567583E+02, 9.042786E+01
     &,-1.723894E+01, 5.423752E-02,-1.221070E+00
     &, 4.411812E-01,-4.485821E+00,-7.836137E+00
     &,-1.474880E+01,-1.439542E+01, 2.105855E+01
     &,-4.394746E+00,-1.106006E+01, 5.616985E+00
     &,-2.624260E+02, 7.125586E+02,-8.250168E+02
     &, 4.742407E+02,-1.355175E+02, 1.541889E+01
     &, 0.0, 0.0, 0.0
     &, 0.0, 0.0, 0.0/
! BERYLLIUM
       data (spisok(j),j=408,1739)
     &/ 6., 0.002, 0.02, 0.2, 2.0, 20.0, 100.0
     &,-3.425149E+02,-9.471260E+02,-1.035776E+03
     &,-5.382415E+02,-1.349198E+02,-1.319063E+01
     &,-3.429832E+01,-5.804548E+01,-1.032570E+02
     &,-8.853015E+01,-3.530521E+01,-5.134460E+00
     &,-2.177747E+01, 4.617764E-02, 4.411196E-01
     &,-2.972147E-01, 4.526295E-02, 1.266794E-01
     &,-2.177388E+01, 1.478620E-02, 5.259617E-01
     &,-3.816430E-01, 1.583400E-01,-2.891062E-02
     &,-2.031496E+01,-4.202600E+00, 5.289472E+00
     &,-3.002456E+00, 8.528627E+00,-9.687963E-02
! Not used
     &, 1295*0.0/
!!!!!!!!!!!!!!!!!!!!  end data   !!!!!!!!!!!!!!!!!!!!!!!!!
!
      do i=1,NRD
       coolr(i)=zero
      end do
      iz=n_tabl(iz_imp)
      if(iz.eq.0) return !this ion is not available, cooling rate=0.
!
      i_read=1+37*(iz-1)
      i_slag=int(spisok(i_read))
      do i=i_read+1,i_read+i_slag
       t_e(i-i_read)=spisok(i)
      end do
      k_beg=i_read+7
      do i=k_beg,k_beg+29
       work_a(i-k_beg+1)=spisok(i)
      end do
      do k=1,i_slag-1
       do i=1+(k-1)*6,k*6
        a_coef(k,i-(k-1)*6)=work_a(i)
       end do
      end do
!
      do j=1,NA1  !NA1=used ASTRA radial grid number
       kfound=0
       do k=2,i_slag
        if((TE(j)-t_e(k-1))*(TE(j)-t_e(k)).le.zero) then
         kfound=k-1
         go to 1
        end if
       end do
1      continue
       if(kfound.eq.0) then
        coolr(j)=zero !TE(j) is out of table, coolr(j)=0.
       else ! begin cooling rate calculation
        x_x=log10(TE(j))
        p_curr=1.
        pw_out=a_coef(kfound,1)
        do i=2,6
         p_curr=p_curr*x_x
         pw_out=pw_out+a_coef(kfound,i)*p_curr
        end do
        pw_out=pw_out+19.
        pw_out=max(pw_out,-6.d1)
        pw_out=min(pw_out, 6.d1)
        coolr(j)=NE(j)*ni_imp(j)*(10.**pw_out)  ! [MW/m^3]
       end if
      end do
      end
